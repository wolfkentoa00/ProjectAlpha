<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleek Tuner | Performance Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Modern Dark Theme - Focused on Data Clarity */
        :root {
            --bg-main: #09090b;
            --bg-card: #18181b;
            --accent: #3b82f6; /* Blue */
            --accent-hover: #2563eb;
            --text-main: #f4f4f5;
            --text-muted: #a1a1aa;
            --border: #27272a;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
        }

        /* Smooth Transitions */
        .transition-all { transition: all 0.2s ease-in-out; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-main); }
        ::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #52525b; }

        /* Card Styling */
        .card {
            background-color: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        /* Car List Item */
        .car-item {
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .car-item:hover { background-color: #27272a; }
        .car-item.active {
            background-color: #1e293b;
            border-color: var(--accent);
        }

        /* Switch Toggle */
        .toggle-checkbox:checked {
            right: 0;
            border-color: var(--accent);
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: var(--accent);
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="h-16 border-b border-[#27272a] flex items-center px-6 bg-[#09090b] shrink-0 z-20">
        <div class="flex items-center gap-2">
            <div class="w-1 h-6 bg-blue-500 rounded-full"></div>
            <h1 class="text-xl font-bold tracking-tight">SLEEK<span class="text-blue-500">TUNER</span></h1>
        </div>
        <div class="ml-auto text-sm text-gray-500">
            Virtual Performance Lab
        </div>
    </header>

    <!-- Main Layout -->
    <main class="flex-1 flex overflow-hidden">
        
        <!-- LEFT: Car Selector (Scrollable Sidebar) -->
        <aside class="w-80 border-r border-[#27272a] bg-[#0c0c0e] flex flex-col shrink-0">
            <div class="p-4 border-b border-[#27272a]">
                <input type="text" id="search-input" placeholder="Search vehicles..." 
                       class="w-full bg-[#18181b] border border-[#27272a] rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500 transition-colors text-white">
            </div>
            <div class="flex-1 overflow-y-auto p-2 space-y-1" id="car-list">
                <!-- Cars injected here -->
            </div>
        </aside>

        <!-- RIGHT: Workspace (Scrollable) -->
        <div class="flex-1 overflow-y-auto bg-[#09090b] p-6 md:p-10">
            <div class="max-w-6xl mx-auto space-y-8">
                
                <!-- Active Car Header -->
                <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-4 pb-6 border-b border-[#27272a]">
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-blue-900/30 text-blue-400 border border-blue-900/50" id="badge-brand">BRAND</span>
                            <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-gray-800 text-gray-400 border border-gray-700" id="badge-engine">ENGINE</span>
                        </div>
                        <h2 class="text-4xl font-bold text-white" id="car-name">Select Vehicle</h2>
                        <p class="text-gray-400 mt-1 text-sm" id="car-desc">Vehicle description...</p>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-gray-500 uppercase tracking-wider">Base Power</div>
                        <div class="text-2xl font-mono font-bold text-white" id="base-power">0 HP</div>
                    </div>
                </div>

                <!-- Config & Stats Split -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    <!-- MOD CONFIGURATION -->
                    <div class="lg:col-span-4 space-y-6">
                        
                        <!-- Tune Selection -->
                        <div class="card p-5">
                            <h3 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide">Software</h3>
                            <div class="space-y-2">
                                <label class="flex items-center justify-between p-3 rounded-lg border border-[#27272a] cursor-pointer hover:bg-[#27272a] transition-all">
                                    <span class="text-sm font-medium">Stock Map</span>
                                    <input type="radio" name="tune" value="stock" class="accent-blue-500 w-4 h-4" checked onchange="updateSim()">
                                </label>
                                <label class="flex items-center justify-between p-3 rounded-lg border border-[#27272a] cursor-pointer hover:bg-[#27272a] transition-all">
                                    <div>
                                        <div class="text-sm font-medium text-white">Piggyback (JB4)</div>
                                        <div class="text-[10px] text-gray-500">Keep Warranty</div>
                                    </div>
                                    <input type="radio" name="tune" value="jb4" class="accent-blue-500 w-4 h-4" onchange="updateSim()">
                                </label>
                                <label class="flex items-center justify-between p-3 rounded-lg border border-[#27272a] cursor-pointer hover:bg-[#27272a] transition-all">
                                    <div>
                                        <div class="text-sm font-medium text-blue-400">Flash Tune</div>
                                        <div class="text-[10px] text-gray-500">Maximum Gains</div>
                                    </div>
                                    <input type="radio" name="tune" value="flash" class="accent-blue-500 w-4 h-4" onchange="updateSim()">
                                </label>
                            </div>
                        </div>

                        <!-- Hardware Selection -->
                        <div class="card p-5">
                            <h3 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide">Hardware</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-300">Cold Air Intake</span>
                                    <input type="checkbox" id="mod-intake" class="w-5 h-5 rounded bg-[#27272a] border-gray-600 accent-blue-500" onchange="updateSim()">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-300">High-Flow Downpipes</span>
                                    <input type="checkbox" id="mod-dp" class="w-5 h-5 rounded bg-[#27272a] border-gray-600 accent-blue-500" onchange="updateSim()">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-300">Catback Exhaust</span>
                                    <input type="checkbox" id="mod-exhaust" class="w-5 h-5 rounded bg-[#27272a] border-gray-600 accent-blue-500" onchange="updateSim()">
                                </div>
                                <div class="pt-3 mt-3 border-t border-[#27272a] flex items-center justify-between">
                                    <div>
                                        <div class="text-sm text-red-400 font-medium" id="turbo-label">Upgraded Turbo</div>
                                        <div class="text-[10px] text-gray-500">Requires Tune</div>
                                    </div>
                                    <input type="checkbox" id="mod-turbo" class="w-5 h-5 rounded bg-[#27272a] border-gray-600 accent-red-500" onchange="updateSim()">
                                </div>
                            </div>
                        </div>

                        <!-- Fuel -->
                        <div class="card p-5">
                            <h3 class="text-sm font-semibold text-gray-300 mb-4 uppercase tracking-wide">Fuel</h3>
                            <div class="grid grid-cols-2 gap-2">
                                <label class="cursor-pointer text-center py-2 rounded bg-[#27272a] border border-transparent hover:border-blue-500 has-[:checked]:bg-blue-900/20 has-[:checked]:border-blue-500 transition-all">
                                    <input type="radio" name="fuel" value="93" class="hidden" checked onchange="updateSim()">
                                    <span class="text-xs font-bold text-white">93 Oct</span>
                                </label>
                                <label class="cursor-pointer text-center py-2 rounded bg-[#27272a] border border-transparent hover:border-red-500 has-[:checked]:bg-red-900/20 has-[:checked]:border-red-500 transition-all">
                                    <input type="radio" name="fuel" value="e85" class="hidden" onchange="updateSim()">
                                    <span class="text-xs font-bold text-white">E85 Mix</span>
                                </label>
                            </div>
                        </div>

                    </div>

                    <!-- DATA VISUALIZATION -->
                    <div class="lg:col-span-8 space-y-6">
                        
                        <!-- The Numbers -->
                        <div class="grid grid-cols-3 gap-4">
                            <div class="card p-4 text-center border-t-4 border-t-blue-500">
                                <div class="text-xs text-gray-500 uppercase">Peak Power</div>
                                <div class="text-3xl font-bold text-white mt-1" id="val-hp">0</div>
                                <div class="text-xs text-green-500 mt-1" id="gain-hp">+0 Gain</div>
                            </div>
                            <div class="card p-4 text-center border-t-4 border-t-purple-500">
                                <div class="text-xs text-gray-500 uppercase">Peak Torque</div>
                                <div class="text-3xl font-bold text-white mt-1" id="val-tq">0</div>
                                <div class="text-xs text-green-500 mt-1" id="gain-tq">+0 Gain</div>
                            </div>
                            <div class="card p-4 text-center border-t-4 border-t-green-500">
                                <div class="text-xs text-gray-500 uppercase">Est. Cost</div>
                                <div class="text-3xl font-bold text-white mt-1" id="val-cost">$0</div>
                                <div class="text-xs text-gray-500 mt-1">Parts Only</div>
                            </div>
                        </div>

                        <!-- THE DYNO CHART -->
                        <div class="card p-4 bg-[#0c0c0e]">
                            <div class="flex justify-between items-center mb-4 px-2">
                                <h3 class="text-sm font-semibold text-gray-300">Dyno Graph (HP & TQ)</h3>
                                <div class="flex gap-4 text-xs">
                                    <div class="flex items-center gap-1">
                                        <span class="w-3 h-1 bg-gray-600"></span> Stock
                                    </div>
                                    <div class="flex items-center gap-1">
                                        <span class="w-3 h-1 bg-blue-500"></span> Tuned HP
                                    </div>
                                    <div class="flex items-center gap-1">
                                        <span class="w-3 h-1 bg-purple-500 border-b border-purple-500 border-dashed"></span> Tuned TQ
                                    </div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="dynoChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Simple Alert Area -->
                        <div id="alert-box" class="hidden p-3 rounded-lg bg-red-900/20 border border-red-900 text-red-200 text-sm text-center">
                            Warning: Configuration unsafe.
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // --- CAR DATA ---
        const cars = [
            // BMW
            { id: 'm340', brand: 'BMW', name: 'M340i (G20)', engine: 'B58 3.0T', type: 'turbo', hp: 382, tq: 369, desc: "The benchmark daily driver. Robust B58 engine." },
            { id: 'm3', brand: 'BMW', name: 'M3 Comp (G80)', engine: 'S58 3.0TT', type: 'turbo', hp: 503, tq: 479, desc: "Track weapon. S58 engine loves high RPM." },
            { id: 'm5', brand: 'BMW', name: 'M5 Comp (F90)', engine: 'S63 4.4TT V8', type: 'turbo', hp: 617, tq: 553, desc: "Executive missile. Massive V8 torque." },
            
            // AUDI
            { id: 'rs3', brand: 'Audi', name: 'RS3 (8Y)', engine: '2.5T I5', type: 'turbo', hp: 401, tq: 369, desc: "The 5-cylinder sound. Pocket rocket." },
            { id: 'r8', brand: 'Audi', name: 'R8 V10 Perf', engine: '5.2L V10', type: 'na', hp: 602, tq: 413, desc: "Naturally Aspirated V10. Linear power delivery." },
            { id: 'rs7', brand: 'Audi', name: 'RS7 (C8)', engine: '4.0TT V8', type: 'turbo', hp: 591, tq: 590, desc: "Autobahn stormer. Effortless speed." },

            // PORSCHE
            { id: 'gt3rs', brand: 'Porsche', name: '911 GT3 RS', engine: '4.0L Flat-6', type: 'na', hp: 518, tq: 342, desc: "High revving NA masterpiece. 9000 RPM redline." },
            { id: 'turboS', brand: 'Porsche', name: '911 Turbo S', engine: '3.8TT Flat-6', type: 'turbo', hp: 640, tq: 590, desc: "The acceleration king. Launch control master." },

            // SUPER
            { id: 'huracan', brand: 'Lamborghini', name: 'HuracÃ¡n EVO', engine: '5.2L V10', type: 'na', hp: 630, tq: 443, desc: "Sharp, loud, and immediate response." },
            { id: 'gtr', brand: 'Nissan', name: 'GT-R (R35)', engine: 'VR38DETT', type: 'turbo', hp: 565, tq: 467, desc: "Godzilla. Easy to tune for massive power." }
        ];

        let activeCar = cars[0];
        let myChart = null;

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            renderCarList();
            initChart();
            selectCar('m340');
            
            // Filter functionality
            document.getElementById('search-input').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const items = document.querySelectorAll('.car-item');
                items.forEach(item => {
                    const name = item.querySelector('.car-name-text').innerText.toLowerCase();
                    item.style.display = name.includes(term) ? 'block' : 'none';
                });
            });
        });

        function renderCarList() {
            const list = document.getElementById('car-list');
            list.innerHTML = cars.map(car => `
                <div class="car-item p-3 rounded-lg" onclick="selectCar('${car.id}')" id="item-${car.id}">
                    <div class="flex justify-between items-center">
                        <span class="text-xs font-bold text-gray-500 uppercase">${car.brand}</span>
                        <span class="text-[10px] px-1.5 py-0.5 rounded bg-[#27272a] text-gray-400">${car.type.toUpperCase()}</span>
                    </div>
                    <div class="text-sm font-semibold text-gray-200 car-name-text">${car.name}</div>
                </div>
            `).join('');
        }

        function selectCar(id) {
            activeCar = cars.find(c => c.id === id);
            
            // UI Updates
            document.querySelectorAll('.car-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`item-${id}`).classList.add('active');

            document.getElementById('car-name').innerText = activeCar.name;
            document.getElementById('car-desc').innerText = activeCar.desc;
            document.getElementById('badge-brand').innerText = activeCar.brand;
            document.getElementById('badge-engine').innerText = activeCar.engine;
            document.getElementById('base-power').innerText = activeCar.hp + " HP";

            // Update Turbo Label for NA cars
            const turboLabel = document.getElementById('turbo-label');
            if (activeCar.type === 'na') {
                turboLabel.innerText = "Twin Turbo Kit (Conversion)";
            } else {
                turboLabel.innerText = "Upgraded Turbo";
            }

            updateSim();
        }

        function updateSim() {
            const tune = document.querySelector('input[name="tune"]:checked').value;
            const intake = document.getElementById('mod-intake').checked;
            const dp = document.getElementById('mod-dp').checked;
            const exhaust = document.getElementById('mod-exhaust').checked;
            const turbo = document.getElementById('mod-turbo').checked;
            const fuel = document.querySelector('input[name="fuel"]:checked').value;
            const alertBox = document.getElementById('alert-box');

            let hp = activeCar.hp;
            let tq = activeCar.tq;
            let cost = 0;
            
            // Base Mod logic
            const isNA = activeCar.type === 'na';

            if (intake) { 
                hp += 8; 
                cost += 450; 
            }
            if (exhaust) { 
                cost += 2000; 
                // Exhaust is mostly sound, minimal HP without tune
            }
            if (dp) { 
                hp += isNA ? 15 : 10; // Headers on NA vs Downpipe on Turbo
                tq += 10;
                cost += isNA ? 2500 : 600; // Headers are pricey
            }

            // Turbo/Supercharger Logic
            if (turbo) {
                if (isNA) {
                    // Twin Turbo Kit
                    hp += 250; // Big jump
                    tq += 180;
                    cost += 20000;
                } else {
                    // Hybrid Turbo
                    hp += 80;
                    tq += 40;
                    cost += 3500;
                }
            }

            // Tune Multipliers
            let tuneMult = 0;
            if (tune === 'jb4') {
                cost += 550;
                tuneMult = 0.12;
            } else if (tune === 'flash') {
                cost += 1200;
                tuneMult = 0.20;
                if (dp) tuneMult += 0.05; // Stage 2
            }

            // Fuel Multiplier
            if (fuel === 'e85') {
                tuneMult += 0.10;
            }

            // Apply Tune
            let finalHP = hp + (activeCar.hp * tuneMult);
            let finalTQ = tq + (activeCar.tq * tuneMult);

            // Safety Alert
            if (fuel === 'e85' && !tune) {
                alertBox.classList.remove('hidden');
                alertBox.innerText = "Warning: Cannot run E85 on Stock Map. Engine risk high.";
            } else {
                alertBox.classList.add('hidden');
            }

            // Update Numbers
            document.getElementById('val-hp').innerText = Math.round(finalHP);
            document.getElementById('val-tq').innerText = Math.round(finalTQ);
            document.getElementById('val-cost').innerText = "$" + cost.toLocaleString();
            
            document.getElementById('gain-hp').innerText = `+${Math.round(finalHP - activeCar.hp)} Gain`;
            document.getElementById('gain-tq').innerText = `+${Math.round(finalTQ - activeCar.tq)} Gain`;

            updateChart(activeCar.hp, activeCar.tq, finalHP, finalTQ, activeCar.type);
        }

        // --- CHART CONFIG ---
        function initChart() {
            const ctx = document.getElementById('dynoChart').getContext('2d');
            Chart.defaults.color = '#52525b';
            Chart.defaults.font.family = 'Inter';

            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [2, 3, 4, 5, 6, 7], // RPM x1000
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { display: false }, // Custom legend in HTML
                        tooltip: {
                            backgroundColor: '#18181b',
                            borderColor: '#27272a',
                            borderWidth: 1,
                            titleColor: '#fff',
                            bodyColor: '#a1a1aa'
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#27272a', drawBorder: false },
                            title: { display: true, text: 'RPM (x1000)' }
                        },
                        y: {
                            grid: { color: '#27272a', drawBorder: false },
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        function updateChart(stockPeakHP, stockPeakTQ, modPeakHP, modPeakTQ, type) {
            
            // Generate realistic-ish curves based on engine type
            const rpmPoints = [2000, 3000, 4000, 5000, 6000, 7000];
            
            const stockHPData = [];
            const modHPData = [];
            const modTQData = [];

            rpmPoints.forEach((rpm, i) => {
                const progress = i / (rpmPoints.length - 1); // 0 to 1
                
                // Curve Shape Logic
                let hpFactor, tqFactor;

                if (type === 'na') {
                    // Linear climb for HP, flat torque
                    hpFactor = 0.3 + (0.7 * progress); 
                    tqFactor = 0.8 + (0.2 * Math.sin(progress * Math.PI)); 
                } else {
                    // Turbo: Torque peaks early, HP climbs then flattens
                    hpFactor = 0.4 + (0.6 * Math.pow(progress, 0.8));
                    tqFactor = 0.9 + (0.1 * Math.cos((progress - 0.3) * 2)); // Bump in mid range
                }

                stockHPData.push(stockPeakHP * hpFactor);
                modHPData.push(modPeakHP * hpFactor);
                
                // Torque calculation (HP = TQ * RPM / 5252) approximate reverse logic for display
                // Just simulating relative curve here
                modTQData.push(modPeakTQ * tqFactor);
            });

            myChart.data.labels = rpmPoints;
            
            myChart.data.datasets = [
                {
                    label: 'Stock HP',
                    data: stockHPData,
                    borderColor: '#52525b', // Gray
                    borderWidth: 2,
                    borderDash: [5, 5],
                    pointRadius: 0,
                    tension: 0.4
                },
                {
                    label: 'Tuned HP',
                    data: modHPData,
                    borderColor: '#3b82f6', // Blue
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 3,
                    pointRadius: 3,
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Tuned TQ',
                    data: modTQData,
                    borderColor: '#a855f7', // Purple
                    borderWidth: 2,
                    borderDash: [3, 3],
                    pointRadius: 0,
                    tension: 0.4
                }
            ];
            
            myChart.update();
        }
    </script>
</body>
</html>
